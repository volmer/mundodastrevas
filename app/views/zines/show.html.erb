<% content_for :page_title, @zine %>
<% content_for :page_author, @zine.user %>
<% content_for :page_description, truncate_rich(@zine.description) %>
<% content_for :page_canonical_url, zine_url(@zine) %>
<% content_for :page_image, URI(root_url) + @zine.image.url %>
<% content_for :page_updated_at, @zine.updated_at %>
<% content_for :page_see_also, zine_post_url(@zine, @zine.posts.first) if @zine.posts.any? %>

<h1><%= @zine %></h1>

<div class="row">
  <div class="col-md-8">
    <% if @zine.image.file.present? %>
      <%= image_tag @zine.image.url, class: 'zine-image img-fluid' %>
    <% end %>

    <div class="zine-description"><%= sanitize @zine.description %></div>

    <% @posts.each do |post| %>
      <div class="list-item-with-image post-list-item">
        <%= link_to [post.zine, post] do %>
          <%= image_tag post.image.small.url %>
        <% end %>

        <h4><%= link_to post, [post.zine, post] %></h4>

        <p>
          <%= truncate_rich(post.content) do %>
            <%= link_to t('.more'), [post.zine, post] %>
          <% end %>
        </p>
      </div>
    <% end %>

    <%= paginate @posts %>

    <% if @posts.empty? %>
      <div class="alert alert-info"><%= t '.empty' %></div>
    <% end %>
  </div>

  <div class="col-md-4">
    <%= render 'author', user: @zine.user %>

    <h5><%= t '.posts', zine: @zine %></h5>

    <div class="list-group">
      <% @zine.posts.order(created_at: :desc).each do |post| %>
        <%= link_to post, zine_post_path(@zine, post), class: 'list-group-item' %>
      <% end %>
    </div>
  </div>
</div>
